<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriCare - Professional Dietitian Services</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .spinner { border: 3px solid #f3f3f3; border-top: 3px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="min-h-screen">
        <!-- Navigation -->
        <nav class="bg-white shadow-lg sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <h1 class="text-2xl font-bold text-green-600">ü•ó NutriCare</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button onclick="showPage('home')" class="nav-link px-3 py-2 text-gray-700 hover:text-green-600">Home</button>
                        <button onclick="showPage('services')" class="nav-link px-3 py-2 text-gray-700 hover:text-green-600">Services</button>
                        <button onclick="showPage('calculators')" class="nav-link px-3 py-2 text-gray-700 hover:text-green-600">Calculators</button>
                        <button onclick="showPage('articles')" class="nav-link px-3 py-2 text-gray-700 hover:text-green-600">Blog</button>
                        <button id="dashboardBtn" onclick="showPage('dashboard')" class="nav-link px-3 py-2 text-gray-700 hover:text-green-600 hidden">Dashboard</button>
                        <button id="loginBtn" onclick="showPage('login')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">Login</button>
                        <button id="logoutBtn" onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 hidden">Logout</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content Container -->
        <div id="content" class="fade-in">
            <!-- Home Page -->
            <div id="homePage" class="page">
                <!-- Hero Section -->
                <section class="bg-gradient-to-r from-green-500 to-blue-600 text-white py-20">
                    <div class="max-w-7xl mx-auto px-4 text-center">
                        <h2 class="text-5xl font-bold mb-4">Transform Your Health with Expert Nutrition Guidance</h2>
                        <p class="text-xl mb-8">Personalized diet plans, expert consultations, and continuous support for your wellness journey</p>
                        <div class="space-x-4">
                            <button onclick="showPage('register')" class="bg-white text-green-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition">Get Started</button>
                            <button onclick="showPage('services')" class="border-2 border-white px-8 py-3 rounded-lg font-semibold hover:bg-white hover:text-green-600 transition">Learn More</button>
                        </div>
                    </div>
                </section>

                <!-- Features Section -->
                <section class="py-16">
                    <div class="max-w-7xl mx-auto px-4">
                        <h3 class="text-3xl font-bold text-center mb-12">Why Choose NutriCare?</h3>
                        <div class="grid md:grid-cols-3 gap-8">
                            <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                                <div class="text-4xl mb-4">üì±</div>
                                <h4 class="text-xl font-semibold mb-2">Mobile App Access</h4>
                                <p class="text-gray-600">Track your progress on-the-go with our mobile application</p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                                <div class="text-4xl mb-4">üë©‚Äç‚öïÔ∏è</div>
                                <h4 class="text-xl font-semibold mb-2">Expert Dietitians</h4>
                                <p class="text-gray-600">Certified professionals with years of experience</p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                                <div class="text-4xl mb-4">üìä</div>
                                <h4 class="text-xl font-semibold mb-2">Progress Tracking</h4>
                                <p class="text-gray-600">Monitor your health metrics and see real results</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Testimonials -->
                <section class="bg-gray-100 py-16">
                    <div class="max-w-7xl mx-auto px-4">
                        <h3 class="text-3xl font-bold text-center mb-12">Success Stories</h3>
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="bg-white p-6 rounded-lg shadow">
                                <p class="text-gray-600 italic mb-4">"Lost 15 kgs in 3 months with personalized diet plans. The support was amazing!"</p>
                                <p class="font-semibold">- Priya Sharma</p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow">
                                <p class="text-gray-600 italic mb-4">"Finally found a sustainable way to eat healthy. The app makes tracking so easy!"</p>
                                <p class="font-semibold">- Rahul Kumar</p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Services Page -->
            <div id="servicesPage" class="page hidden">
                <div class="max-w-7xl mx-auto px-4 py-12">
                    <h2 class="text-4xl font-bold text-center mb-12">Our Services</h2>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="bg-white p-6 rounded-lg shadow-lg">
                            <h3 class="text-2xl font-semibold mb-4 text-green-600">Personalized Diet Plans</h3>
                            <p class="text-gray-600 mb-4">Custom meal plans based on your health goals, preferences, and lifestyle</p>
                            <ul class="list-disc list-inside text-gray-600">
                                <li>Weekly meal schedules</li>
                                <li>Indian cuisine options</li>
                                <li>Calorie-counted meals</li>
                                <li>Shopping lists included</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-lg">
                            <h3 class="text-2xl font-semibold mb-4 text-green-600">One-on-One Consultations</h3>
                            <p class="text-gray-600 mb-4">Personal sessions with certified dietitians via video call</p>
                            <ul class="list-disc list-inside text-gray-600">
                                <li>30-minute sessions</li>
                                <li>Health assessment</li>
                                <li>Goal setting</li>
                                <li>Q&A support</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-lg">
                            <h3 class="text-2xl font-semibold mb-4 text-green-600">Progress Monitoring</h3>
                            <p class="text-gray-600 mb-4">Track your journey with our comprehensive monitoring tools</p>
                            <ul class="list-disc list-inside text-gray-600">
                                <li>Weight tracking</li>
                                <li>BMI calculations</li>
                                <li>Progress photos</li>
                                <li>Health metrics</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-lg">
                            <h3 class="text-2xl font-semibold mb-4 text-green-600">24/7 Chat Support</h3>
                            <p class="text-gray-600 mb-4">Get your queries answered anytime through our chat system</p>
                            <ul class="list-disc list-inside text-gray-600">
                                <li>WhatsApp integration</li>
                                <li>In-app messaging</li>
                                <li>Quick responses</li>
                                <li>Diet tips & advice</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-lg">
                            <h3 class="text-2xl font-semibold mb-4 text-green-600">Educational Content</h3>
                            <p class="text-gray-600 mb-4">Access to exclusive articles, videos, and recipes</p>
                            <ul class="list-disc list-inside text-gray-600">
                                <li>Nutrition guides</li>
                                <li>Healthy recipes</li>
                                <li>Exercise tips</li>
                                <li>Lifestyle advice</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-lg">
                            <h3 class="text-2xl font-semibold mb-4 text-green-600">Mobile App Access</h3>
                            <p class="text-gray-600 mb-4">Stay connected with our feature-rich mobile application</p>
                            <ul class="list-disc list-inside text-gray-600">
                                <li>iOS & Android</li>
                                <li>Offline access</li>
                                <li>Push notifications</li>
                                <li>Barcode scanner</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calculators Page -->
            <div id="calculatorsPage" class="page hidden">
                <div class="max-w-7xl mx-auto px-4 py-12">
                    <h2 class="text-4xl font-bold text-center mb-12">Health Calculators</h2>
                    
                    <!-- BMI Calculator -->
                    <div class="bg-white p-8 rounded-lg shadow-lg mb-8">
                        <h3 class="text-2xl font-semibold mb-6">BMI Calculator</h3>
                        <div class="grid md:grid-cols-2 gap-8">
                            <div>
                                <div class="mb-4">
                                    <label class="block text-gray-700 mb-2">Height (cm)</label>
                                    <input type="number" id="bmiHeight" class="w-full px-4 py-2 border rounded-lg" placeholder="170">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-gray-700 mb-2">Weight (kg)</label>
                                    <input type="number" id="bmiWeight" class="w-full px-4 py-2 border rounded-lg" placeholder="70">
                                </div>
                                <button onclick="calculateBMI()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Calculate BMI</button>
                            </div>
                            <div id="bmiResult" class="hidden">
                                <div class="bg-gray-100 p-6 rounded-lg">
                                    <h4 class="text-xl font-semibold mb-2">Your BMI: <span id="bmiValue" class="text-green-600"></span></h4>
                                    <p class="text-gray-700 mb-2">Category: <span id="bmiCategory" class="font-semibold"></span></p>
                                    <div class="mt-4">
                                        <div class="text-sm text-gray-600">
                                            <p>Underweight: BMI < 18.5</p>
                                            <p>Normal: BMI 18.5-24.9</p>
                                            <p>Overweight: BMI 25-29.9</p>
                                            <p>Obese: BMI ‚â• 30</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Calorie Calculator -->
                    <div class="bg-white p-8 rounded-lg shadow-lg mb-8">
                        <h3 class="text-2xl font-semibold mb-6">Daily Calorie Calculator</h3>
                        <div class="grid md:grid-cols-2 gap-8">
                            <div>
                                <div class="mb-4">
                                    <label class="block text-gray-700 mb-2">Age</label>
                                    <input type="number" id="calAge" class="w-full px-4 py-2 border rounded-lg" placeholder="25">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-gray-700 mb-2">Gender</label>
                                    <select id="calGender" class="w-full px-4 py-2 border rounded-lg">
                                        <option value="male">Male</option>
                                        <option value="female">Female</option>
                                    </select>
                                </div>
                                <div class="mb-4">
                                    <label class="block text-gray-700 mb-2">Height (cm)</label>
                                    <input type="number" id="calHeight" class="w-full px-4 py-2 border rounded-lg" placeholder="170">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-gray-700 mb-2">Weight (kg)</label>
                                    <input type="number" id="calWeight" class="w-full px-4 py-2 border rounded-lg" placeholder="70">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-gray-700 mb-2">Activity Level</label>
                                    <select id="calActivity" class="w-full px-4 py-2 border rounded-lg">
                                        <option value="1.2">Sedentary (little or no exercise)</option>
                                        <option value="1.375">Lightly active (1-3 days/week)</option>
                                        <option value="1.55">Moderately active (3-5 days/week)</option>
                                        <option value="1.725">Very active (6-7 days/week)</option>
                                        <option value="1.9">Extra active (physical job)</option>
                                    </select>
                                </div>
                                <button onclick="calculateCalories()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Calculate</button>
                            </div>
                            <div id="calorieResult" class="hidden">
                                <div class="bg-gray-100 p-6 rounded-lg">
                                    <h4 class="text-xl font-semibold mb-4">Your Daily Calorie Needs</h4>
                                    <div class="space-y-2">
                                        <p>Maintain weight: <span id="maintainCal" class="font-semibold text-green-600"></span> cal/day</p>
                                        <p>Lose 0.5 kg/week: <span id="loseCal" class="font-semibold text-blue-600"></span> cal/day</p>
                                        <p>Gain 0.5 kg/week: <span id="gainCal" class="font-semibold text-orange-600"></span> cal/day</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Water Intake Calculator -->
                    <div class="bg-white p-8 rounded-lg shadow-lg">
                        <h3 class="text-2xl font-semibold mb-6">Daily Water Intake Calculator</h3>
                        <div class="grid md:grid-cols-2 gap-8">
                            <div>
                                <div class="mb-4">
                                    <label class="block text-gray-700 mb-2">Weight (kg)</label>
                                    <input type="number" id="waterWeight" class="w-full px-4 py-2 border rounded-lg" placeholder="70">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-gray-700 mb-2">Exercise Duration (minutes/day)</label>
                                    <input type="number" id="waterExercise" class="w-full px-4 py-2 border rounded-lg" placeholder="30">
                                </div>
                                <button onclick="calculateWater()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Calculate</button>
                            </div>
                            <div id="waterResult" class="hidden">
                                <div class="bg-gray-100 p-6 rounded-lg">
                                    <h4 class="text-xl font-semibold mb-2">Recommended Water Intake</h4>
                                    <p class="text-3xl font-bold text-blue-600"><span id="waterAmount"></span> Liters/day</p>
                                    <p class="text-gray-600 mt-2">That's about <span id="waterGlasses"></span> glasses of water</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Articles/Blog Page -->
            <div id="articlesPage" class="page hidden">
                <div class="max-w-7xl mx-auto px-4 py-12">
                    <h2 class="text-4xl font-bold text-center mb-12">Health & Nutrition Blog</h2>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8" id="articlesGrid">
                        <!-- Articles will be loaded dynamically -->
                    </div>
                </div>
            </div>

            <!-- Login Page -->
            <div id="loginPage" class="page hidden">
                <div class="max-w-md mx-auto mt-20 p-8 bg-white rounded-lg shadow-lg">
                    <h2 class="text-3xl font-bold text-center mb-8">Login</h2>
                    <form onsubmit="login(event)">
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Username or Email</label>
                            <input type="text" id="loginUsername" class="w-full px-4 py-2 border rounded-lg" required>
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2">Password</label>
                            <input type="password" id="loginPassword" class="w-full px-4 py-2 border rounded-lg" required>
                        </div>
                        <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">Login</button>
                    </form>
                    <p class="text-center mt-4">
                        Don't have an account? 
                        <a href="#" onclick="showPage('register')" class="text-green-600 hover:underline">Register</a>
                    </p>
                    <div class="mt-6 p-4 bg-gray-100 rounded">
                        <p class="text-sm text-gray-600">Demo Credentials:</p>
                        <p class="text-sm">Dietitian: dr.priya / dietitian123</p>
                        <p class="text-sm">Client: rahul.kumar / client123</p>
                    </div>
                </div>
            </div>

            <!-- Register Page -->
            <div id="registerPage" class="page hidden">
                <div class="max-w-md mx-auto mt-20 p-8 bg-white rounded-lg shadow-lg">
                    <h2 class="text-3xl font-bold text-center mb-8">Register</h2>
                    <form onsubmit="register(event)">
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Full Name</label>
                            <input type="text" id="regFullName" class="w-full px-4 py-2 border rounded-lg" required>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Username</label>
                            <input type="text" id="regUsername" class="w-full px-4 py-2 border rounded-lg" required>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Email</label>
                            <input type="email" id="regEmail" class="w-full px-4 py-2 border rounded-lg" required>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Phone</label>
                            <input type="tel" id="regPhone" class="w-full px-4 py-2 border rounded-lg">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2">Password</label>
                            <input type="password" id="regPassword" class="w-full px-4 py-2 border rounded-lg" required>
                        </div>
                        <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">Register</button>
                    </form>
                    <p class="text-center mt-4">
                        Already have an account? 
                        <a href="#" onclick="showPage('login')" class="text-green-600 hover:underline">Login</a>
                    </p>
                </div>
            </div>

            <!-- Dashboard Page -->
            <div id="dashboardPage" class="page hidden">
                <div class="max-w-7xl mx-auto px-4 py-8">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold">Welcome, <span id="userName"></span>!</h2>
                        <p class="text-gray-600">Role: <span id="userRole" class="font-semibold"></span></p>
                    </div>

                    <!-- Tabs -->
                    <div class="border-b border-gray-200 mb-8">
                        <nav class="-mb-px flex space-x-8">
                            <button onclick="showDashboardTab('overview')" class="dashboard-tab py-2 px-1 border-b-2 font-medium text-sm border-green-500 text-green-600">Overview</button>
                            <button onclick="showDashboardTab('appointments')" class="dashboard-tab py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">Appointments</button>
                            <button onclick="showDashboardTab('dietplans')" class="dashboard-tab py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">Diet Plans</button>
                            <button onclick="showDashboardTab('progress')" class="dashboard-tab py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">Progress</button>
                            <button onclick="showDashboardTab('payments')" class="dashboard-tab py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">Payments</button>
                            <button onclick="showDashboardTab('messages')" class="dashboard-tab py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">Messages</button>
                            <button id="clientsTab" onclick="showDashboardTab('clients')" class="dashboard-tab py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 hidden">Clients</button>
                        </nav>
                    </div>

                    <!-- Tab Content -->
                    <!-- Overview Tab -->
                    <div id="overviewTab" class="dashboard-content">
                        <div class="grid md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-white p-6 rounded-lg shadow">
                                <h3 class="text-lg font-semibold mb-2">Health Metrics</h3>
                                <div id="healthMetrics">
                                    <p>Weight: <span id="currentWeight">--</span> kg</p>
                                    <p>BMI: <span id="currentBMI">--</span></p>
                                    <p>Target Weight: <span id="targetWeight">--</span> kg</p>
                                </div>
                                <button onclick="updateHealthMetrics()" class="mt-4 text-green-600 hover:underline">Update Metrics</button>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow">
                                <h3 class="text-lg font-semibold mb-2">Upcoming Appointments</h3>
                                <div id="upcomingAppointments">
                                    <p class="text-gray-600">Loading...</p>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow">
                                <h3 class="text-lg font-semibold mb-2">Active Diet Plan</h3>
                                <div id="activeDietPlan">
                                    <p class="text-gray-600">Loading...</p>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Chart -->
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h3 class="text-lg font-semibold mb-4">Weight Progress</h3>
                            <canvas id="progressChart" width="400" height="100"></canvas>
                        </div>
                    </div>

                    <!-- Appointments Tab -->
                    <div id="appointmentsTab" class="dashboard-content hidden">
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b">
                                <div class="flex justify-between items-center">
                                    <h3 class="text-xl font-semibold">Appointments</h3>
                                    <button onclick="showBookAppointment()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">Book New</button>
                                </div>
                            </div>
                            <div id="appointmentsList" class="p-6">
                                <!-- Appointments will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Diet Plans Tab -->
                    <div id="dietplansTab" class="dashboard-content hidden">
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b">
                                <div class="flex justify-between items-center">
                                    <h3 class="text-xl font-semibold">Diet Plans</h3>
                                    <button id="createDietPlanBtn" onclick="showCreateDietPlan()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 hidden">Create New</button>
                                </div>
                            </div>
                            <div id="dietPlansList" class="p-6">
                                <!-- Diet plans will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Progress Tab -->
                    <div id="progressTab" class="dashboard-content hidden">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-xl font-semibold mb-6">Track Your Progress</h3>
                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="text-lg font-semibold mb-4">Add New Entry</h4>
                                    <form onsubmit="addProgressEntry(event)">
                                        <div class="mb-4">
                                            <label class="block text-gray-700 mb-2">Metric Type</label>
                                            <select id="progressMetric" class="w-full px-4 py-2 border rounded-lg">
                                                <option value="weight">Weight (kg)</option>
                                                <option value="waist">Waist (cm)</option>
                                                <option value="chest">Chest (cm)</option>
                                                <option value="arms">Arms (cm)</option>
                                            </select>
                                        </div>
                                        <div class="mb-4">
                                            <label class="block text-gray-700 mb-2">Value</label>
                                            <input type="number" id="progressValue" step="0.1" class="w-full px-4 py-2 border rounded-lg" required>
                                        </div>
                                        <div class="mb-4">
                                            <label class="block text-gray-700 mb-2">Notes (optional)</label>
                                            <textarea id="progressNotes" class="w-full px-4 py-2 border rounded-lg" rows="3"></textarea>
                                        </div>
                                        <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Add Entry</button>
                                    </form>
                                </div>
                                <div>
                                    <h4 class="text-lg font-semibold mb-4">Recent Entries</h4>
                                    <div id="progressEntries" class="space-y-2">
                                        <!-- Progress entries will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Payments Tab -->
                    <div id="paymentsTab" class="dashboard-content hidden">
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b">
                                <h3 class="text-xl font-semibold">Payments</h3>
                            </div>
                            <div id="paymentsList" class="p-6">
                                <!-- Payments will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Messages Tab -->
                    <div id="messagesTab" class="dashboard-content hidden">
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-4">Messages</h3>
                                <div class="bg-gray-100 p-8 rounded text-center">
                                    <p class="text-gray-600">Chat system coming soon!</p>
                                    <p class="text-sm text-gray-500 mt-2">Meanwhile, contact us on WhatsApp: +91 98765 43210</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Clients Tab (for Dietitians) -->
                    <div id="clientsTab" class="dashboard-content hidden">
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b">
                                <h3 class="text-xl font-semibold">Client Management</h3>
                            </div>
                            <div id="clientsList" class="p-6">
                                <!-- Clients will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modals -->
        <!-- Book Appointment Modal -->
        <div id="bookAppointmentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center">
            <div class="bg-white rounded-lg p-8 max-w-md w-full">
                <h3 class="text-2xl font-semibold mb-4">Book Appointment</h3>
                <form onsubmit="bookAppointment(event)">
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Date</label>
                        <input type="date" id="appointmentDate" class="w-full px-4 py-2 border rounded-lg" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Time Slot</label>
                        <select id="appointmentTime" class="w-full px-4 py-2 border rounded-lg" required>
                            <option value="9:00 AM - 9:30 AM">9:00 AM - 9:30 AM</option>
                            <option value="10:00 AM - 10:30 AM">10:00 AM - 10:30 AM</option>
                            <option value="11:00 AM - 11:30 AM">11:00 AM - 11:30 AM</option>
                            <option value="2:00 PM - 2:30 PM">2:00 PM - 2:30 PM</option>
                            <option value="3:00 PM - 3:30 PM">3:00 PM - 3:30 PM</option>
                            <option value="4:00 PM - 4:30 PM">4:00 PM - 4:30 PM</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Consultation Type</label>
                        <select id="consultationType" class="w-full px-4 py-2 border rounded-lg" required>
                            <option value="Initial Consultation">Initial Consultation</option>
                            <option value="Follow-up">Follow-up</option>
                            <option value="Diet Plan Review">Diet Plan Review</option>
                            <option value="Progress Check">Progress Check</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Notes (optional)</label>
                        <textarea id="appointmentNotes" class="w-full px-4 py-2 border rounded-lg" rows="3"></textarea>
                    </div>
                    <div class="flex space-x-4">
                        <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Book</button>
                        <button type="button" onclick="closeModal('bookAppointmentModal')" class="bg-gray-400 text-white px-6 py-2 rounded-lg hover:bg-gray-500">Cancel</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Payment QR Modal -->
        <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center">
            <div class="bg-white rounded-lg p-8 max-w-md w-full">
                <h3 class="text-2xl font-semibold mb-4">Make Payment</h3>
                <div class="text-center">
                    <div id="qrcode" class="flex justify-center mb-4"></div>
                    <p class="mb-2">Amount: ‚Çπ<span id="paymentAmount"></span></p>
                    <p class="text-sm text-gray-600 mb-4">Scan QR code with any UPI app</p>
                    <button onclick="confirmPayment()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 mr-2">I've Made Payment</button>
                    <button onclick="closeModal('paymentModal')" class="bg-gray-400 text-white px-6 py-2 rounded-lg hover:bg-gray-500">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let currentPage = 'home';
        let currentPaymentId = null;
        const API_URL = 'http://localhost:3001/api';

        // Check if user is logged in on page load
        window.onload = function() {
            const token = localStorage.getItem('token');
            if (token) {
                currentUser = JSON.parse(localStorage.getItem('user'));
                updateUIForLoggedInUser();
            }
            showPage('home');
            loadArticles();
        };

        // Page Navigation
        function showPage(page) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
            
            // Show requested page
            const pageElement = document.getElementById(page + 'Page');
            if (pageElement) {
                pageElement.classList.remove('hidden');
                currentPage = page;
                
                // Load page-specific data
                if (page === 'dashboard' && currentUser) {
                    loadDashboard();
                }
            }
        }

        // Dashboard Tab Navigation
        function showDashboardTab(tab) {
            // Hide all tabs
            document.querySelectorAll('.dashboard-content').forEach(t => t.classList.add('hidden'));
            
            // Show requested tab
            document.getElementById(tab + 'Tab').classList.remove('hidden');
            
            // Update tab styling
            document.querySelectorAll('.dashboard-tab').forEach(t => {
                t.classList.remove('border-green-500', 'text-green-600');
                t.classList.add('border-transparent', 'text-gray-500');
            });
            event.target.classList.remove('border-transparent', 'text-gray-500');
            event.target.classList.add('border-green-500', 'text-green-600');
            
            // Load tab-specific data
            if (tab === 'appointments') loadAppointments();
            if (tab === 'dietplans') loadDietPlans();
            if (tab === 'progress') loadProgress();
            if (tab === 'payments') loadPayments();
            if (tab === 'clients') loadClients();
        }

        // Authentication Functions
        async function login(event) {
            event.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                const response = await axios.post(`${API_URL}/auth/login`, {
                    username,
                    password
                });
                
                localStorage.setItem('token', response.data.token);
                localStorage.setItem('user', JSON.stringify(response.data.user));
                currentUser = response.data.user;
                
                updateUIForLoggedInUser();
                showPage('dashboard');
                showNotification('Login successful!', 'success');
            } catch (error) {
                showNotification('Invalid credentials', 'error');
            }
        }

        async function register(event) {
            event.preventDefault();
            const data = {
                fullName: document.getElementById('regFullName').value,
                username: document.getElementById('regUsername').value,
                email: document.getElementById('regEmail').value,
                phone: document.getElementById('regPhone').value,
                password: document.getElementById('regPassword').value
            };
            
            try {
                const response = await axios.post(`${API_URL}/auth/register`, data);
                
                localStorage.setItem('token', response.data.token);
                localStorage.setItem('user', JSON.stringify(response.data.user));
                currentUser = response.data.user;
                
                updateUIForLoggedInUser();
                showPage('dashboard');
                showNotification('Registration successful!', 'success');
            } catch (error) {
                showNotification(error.response?.data?.error || 'Registration failed', 'error');
            }
        }

        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            currentUser = null;
            updateUIForLoggedOutUser();
            showPage('home');
            showNotification('Logged out successfully', 'success');
        }

        function updateUIForLoggedInUser() {
            document.getElementById('loginBtn').classList.add('hidden');
            document.getElementById('logoutBtn').classList.remove('hidden');
            document.getElementById('dashboardBtn').classList.remove('hidden');
            
            if (currentUser.role === 'DIETITIAN' || currentUser.role === 'ADMIN') {
                document.getElementById('clientsTab').classList.remove('hidden');
                document.getElementById('createDietPlanBtn').classList.remove('hidden');
            }
            
            document.getElementById('userName').textContent = currentUser.fullName;
            document.getElementById('userRole').textContent = currentUser.role;
        }

        function updateUIForLoggedOutUser() {
            document.getElementById('loginBtn').classList.remove('hidden');
            document.getElementById('logoutBtn').classList.add('hidden');
            document.getElementById('dashboardBtn').classList.add('hidden');
        }

        // Calculator Functions
        function calculateBMI() {
            const height = parseFloat(document.getElementById('bmiHeight').value) / 100;
            const weight = parseFloat(document.getElementById('bmiWeight').value);
            
            if (height && weight) {
                const bmi = (weight / (height * height)).toFixed(1);
                let category = '';
                
                if (bmi < 18.5) category = 'Underweight';
                else if (bmi < 25) category = 'Normal weight';
                else if (bmi < 30) category = 'Overweight';
                else category = 'Obese';
                
                document.getElementById('bmiValue').textContent = bmi;
                document.getElementById('bmiCategory').textContent = category;
                document.getElementById('bmiResult').classList.remove('hidden');
            }
        }

        function calculateCalories() {
            const age = parseInt(document.getElementById('calAge').value);
            const gender = document.getElementById('calGender').value;
            const height = parseFloat(document.getElementById('calHeight').value);
            const weight = parseFloat(document.getElementById('calWeight').value);
            const activity = parseFloat(document.getElementById('calActivity').value);
            
            if (age && height && weight) {
                let bmr;
                if (gender === 'male') {
                    bmr = 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age);
                } else {
                    bmr = 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age);
                }
                
                const maintenance = Math.round(bmr * activity);
                const loss = Math.round(maintenance - 500);
                const gain = Math.round(maintenance + 500);
                
                document.getElementById('maintainCal').textContent = maintenance;
                document.getElementById('loseCal').textContent = loss;
                document.getElementById('gainCal').textContent = gain;
                document.getElementById('calorieResult').classList.remove('hidden');
            }
        }

        function calculateWater() {
            const weight = parseFloat(document.getElementById('waterWeight').value);
            const exercise = parseInt(document.getElementById('waterExercise').value) || 0;
            
            if (weight) {
                const baseWater = weight * 0.033;
                const exerciseWater = (exercise / 30) * 0.35;
                const totalWater = (baseWater + exerciseWater).toFixed(1);
                const glasses = Math.round(totalWater * 4);
                
                document.getElementById('waterAmount').textContent = totalWater;
                document.getElementById('waterGlasses').textContent = glasses;
                document.getElementById('waterResult').classList.remove('hidden');
            }
        }

        // Dashboard Functions
        async function loadDashboard() {
            loadUserHealth();
            loadUpcomingAppointments();
            loadActiveDietPlan();
            loadWeightProgress();
        }

        async function loadUserHealth() {
            try {
                const response = await axios.get(`${API_URL}/users/me`, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                const user = response.data;
                document.getElementById('currentWeight').textContent = user.weight || '--';
                document.getElementById('currentBMI').textContent = user.bmi ? user.bmi.toFixed(1) : '--';
                document.getElementById('targetWeight').textContent = '--'; // Would come from goals
            } catch (error) {
                console.error('Error loading health metrics:', error);
            }
        }

        async function loadUpcomingAppointments() {
            try {
                const response = await axios.get(`${API_URL}/appointments`, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                const appointments = response.data;
                const upcoming = appointments.filter(a => new Date(a.date) > new Date() && a.status === 'SCHEDULED');
                
                const container = document.getElementById('upcomingAppointments');
                if (upcoming.length > 0) {
                    container.innerHTML = upcoming.slice(0, 2).map(a => `
                        <div class="mb-2">
                            <p class="font-semibold">${new Date(a.date).toLocaleDateString()}</p>
                            <p class="text-sm text-gray-600">${a.timeSlot}</p>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-600">No upcoming appointments</p>';
                }
            } catch (error) {
                console.error('Error loading appointments:', error);
            }
        }

        async function loadActiveDietPlan() {
            try {
                const response = await axios.get(`${API_URL}/diet-plans`, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                const plans = response.data;
                const active = plans.find(p => p.status === 'ACTIVE');
                
                const container = document.getElementById('activeDietPlan');
                if (active) {
                    container.innerHTML = `
                        <p class="font-semibold">${active.title}</p>
                        <p class="text-sm text-gray-600">${active.targetCalories || '--'} cal/day</p>
                        <a href="#" onclick="showDashboardTab('dietplans')" class="text-green-600 hover:underline text-sm">View Details</a>
                    `;
                } else {
                    container.innerHTML = '<p class="text-gray-600">No active diet plan</p>';
                }
            } catch (error) {
                console.error('Error loading diet plan:', error);
            }
        }

        async function loadWeightProgress() {
            try {
                const response = await axios.get(`${API_URL}/progress?metricType=weight`, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                const progress = response.data;
                if (progress.length > 0) {
                    const ctx = document.getElementById('progressChart').getContext('2d');
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: progress.slice(0, 7).reverse().map(p => new Date(p.recordedAt).toLocaleDateString()),
                            datasets: [{
                                label: 'Weight (kg)',
                                data: progress.slice(0, 7).reverse().map(p => p.value),
                                borderColor: 'rgb(34, 197, 94)',
                                tension: 0.1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                }
            } catch (error) {
                console.error('Error loading progress:', error);
            }
        }

        async function loadAppointments() {
            try {
                const response = await axios.get(`${API_URL}/appointments`, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                const appointments = response.data;
                const container = document.getElementById('appointmentsList');
                
                if (appointments.length > 0) {
                    container.innerHTML = appointments.map(a => `
                        <div class="border-b pb-4 mb-4">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="font-semibold">${new Date(a.date).toLocaleDateString()} - ${a.timeSlot}</p>
                                    <p class="text-gray-600">${a.consultationType}</p>
                                    ${a.notes ? `<p class="text-sm text-gray-500">${a.notes}</p>` : ''}
                                    ${currentUser.role !== 'CLIENT' ? `<p class="text-sm">Client: ${a.user.fullName}</p>` : ''}
                                </div>
                                <span class="px-3 py-1 rounded-full text-sm ${
                                    a.status === 'SCHEDULED' ? 'bg-blue-100 text-blue-800' :
                                    a.status === 'COMPLETED' ? 'bg-green-100 text-green-800' :
                                    a.status === 'CANCELLED' ? 'bg-red-100 text-red-800' :
                                    'bg-gray-100 text-gray-800'
                                }">${a.status}</span>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-600">No appointments found</p>';
                }
            } catch (error) {
                console.error('Error loading appointments:', error);
            }
        }

        async function loadDietPlans() {
            try {
                const response = await axios.get(`${API_URL}/diet-plans`, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                const plans = response.data;
                const container = document.getElementById('dietPlansList');
                
                if (plans.length > 0) {
                    container.innerHTML = plans.map(plan => `
                        <div class="border-b pb-4 mb-4">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h4 class="font-semibold text-lg">${plan.title}</h4>
                                    ${plan.description ? `<p class="text-gray-600">${plan.description}</p>` : ''}
                                    <p class="text-sm text-gray-500">Target: ${plan.targetCalories || '--'} calories/day</p>
                                    ${currentUser.role !== 'CLIENT' ? `<p class="text-sm">Client: ${plan.user.fullName}</p>` : ''}
                                </div>
                                <span class="px-3 py-1 rounded-full text-sm ${
                                    plan.status === 'ACTIVE' ? 'bg-green-100 text-green-800' :
                                    'bg-gray-100 text-gray-800'
                                }">${plan.status}</span>
                            </div>
                            ${plan.meals ? `
                                <button onclick="viewDietPlanDetails(${plan.id})" class="mt-2 text-green-600 hover:underline">View Details</button>
                            ` : ''}
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-600">No diet plans found</p>';
                }
            } catch (error) {
                console.error('Error loading diet plans:', error);
            }
        }

        async function loadProgress() {
            try {
                const response = await axios.get(`${API_URL}/progress`, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                const entries = response.data;
                const container = document.getElementById('progressEntries');
                
                if (entries.length > 0) {
                    container.innerHTML = entries.slice(0, 10).map(entry => `
                        <div class="bg-gray-100 p-3 rounded">
                            <div class="flex justify-between">
                                <span class="font-semibold">${entry.metricType}</span>
                                <span>${entry.value} ${entry.unit || ''}</span>
                            </div>
                            <p class="text-sm text-gray-600">${new Date(entry.recordedAt).toLocaleDateString()}</p>
                            ${entry.notes ? `<p class="text-sm text-gray-500">${entry.notes}</p>` : ''}
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-600">No progress entries yet</p>';
                }
            } catch (error) {
                console.error('Error loading progress:', error);
            }
        }

        async function loadPayments() {
            try {
                const response = await axios.get(`${API_URL}/payments`, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                const payments = response.data;
                const container = document.getElementById('paymentsList');
                
                if (payments.length > 0) {
                    container.innerHTML = payments.map(payment => `
                        <div class="border-b pb-4 mb-4">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="font-semibold">‚Çπ${payment.amount}</p>
                                    <p class="text-gray-600">${payment.serviceType || 'Consultation'}</p>
                                    <p class="text-sm text-gray-500">${new Date(payment.createdAt).toLocaleDateString()}</p>
                                    ${currentUser.role !== 'CLIENT' ? `<p class="text-sm">Client: ${payment.user.fullName}</p>` : ''}
                                </div>
                                <span class="px-3 py-1 rounded-full text-sm ${
                                    payment.status === 'COMPLETED' ? 'bg-green-100 text-green-800' :
                                    payment.status === 'PENDING' ? 'bg-yellow-100 text-yellow-800' :
                                    'bg-red-100 text-red-800'
                                }">${payment.status}</span>
                            </div>
                            ${payment.status === 'PENDING' && currentUser.role === 'CLIENT' ? 
                                `<button onclick="showPaymentQR(${payment.id}, ${payment.amount})" class="mt-2 text-green-600 hover:underline">Pay Now</button>` : 
                                payment.invoices && payment.invoices.length > 0 ?
                                `<p class="text-sm text-gray-500">Invoice: ${payment.invoices[0].invoiceNumber}</p>` : ''
                            }
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-600">No payments found</p>';
                }
            } catch (error) {
                console.error('Error loading payments:', error);
            }
        }

        async function loadClients() {
            if (currentUser.role !== 'DIETITIAN' && currentUser.role !== 'ADMIN') return;
            
            try {
                const response = await axios.get(`${API_URL}/users/clients`, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                const clients = response.data;
                const container = document.getElementById('clientsList');
                
                if (clients.length > 0) {
                    container.innerHTML = clients.map(client => `
                        <div class="border-b pb-4 mb-4">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h4 class="font-semibold">${client.fullName}</h4>
                                    <p class="text-gray-600">${client.email}</p>
                                    ${client.phone ? `<p class="text-sm text-gray-500">Phone: ${client.phone}</p>` : ''}
                                    <div class="text-sm text-gray-500 mt-1">
                                        ${client.weight ? `Weight: ${client.weight}kg` : ''}
                                        ${client.bmi ? ` | BMI: ${client.bmi.toFixed(1)}` : ''}
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm text-gray-500">Joined: ${new Date(client.createdAt).toLocaleDateString()}</p>
                                    <p class="text-sm">Plans: ${client._count.dietPlans} | Appointments: ${client._count.appointments}</p>
                                </div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-600">No clients found</p>';
                }
            } catch (error) {
                console.error('Error loading clients:', error);
            }
        }

        async function loadArticles() {
            // Simulated articles for demo
            const articles = [
                {
                    id: 1,
                    title: '10 Indian Superfoods for Weight Loss',
                    excerpt: 'Discover the power of traditional Indian foods that can help you lose weight naturally...',
                    category: 'Nutrition',
                    author: { fullName: 'Dr. Priya Sharma' },
                    createdAt: new Date()
                },
                {
                    id: 2,
                    title: 'Understanding Your BMI and What It Means',
                    excerpt: 'Body Mass Index (BMI) is a simple calculation using your height and weight...',
                    category: 'Health Education',
                    author: { fullName: 'Dr. Priya Sharma' },
                    createdAt: new Date()
                },
                {
                    id: 3,
                    title: 'The Importance of Hydration in Your Diet',
                    excerpt: 'Water plays a crucial role in maintaining good health and supporting weight loss...',
                    category: 'Wellness',
                    author: { fullName: 'Dr. Priya Sharma' },
                    createdAt: new Date()
                }
            ];
            
            const container = document.getElementById('articlesGrid');
            container.innerHTML = articles.map(article => `
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="p-6">
                        <span class="text-sm text-green-600 font-semibold">${article.category}</span>
                        <h3 class="text-xl font-semibold mt-2 mb-3">${article.title}</h3>
                        <p class="text-gray-600 mb-4">${article.excerpt}</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">By ${article.author.fullName}</span>
                            <button class="text-green-600 hover:underline">Read More ‚Üí</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Action Functions
        function showBookAppointment() {
            document.getElementById('bookAppointmentModal').classList.remove('hidden');
            // Set minimum date to tomorrow
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('appointmentDate').min = tomorrow.toISOString().split('T')[0];
        }

        async function bookAppointment(event) {
            event.preventDefault();
            const data = {
                date: document.getElementById('appointmentDate').value,
                timeSlot: document.getElementById('appointmentTime').value,
                consultationType: document.getElementById('consultationType').value,
                notes: document.getElementById('appointmentNotes').value
            };
            
            try {
                await axios.post(`${API_URL}/appointments`, data, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                closeModal('bookAppointmentModal');
                loadAppointments();
                showNotification('Appointment booked successfully!', 'success');
                
                // Generate payment for appointment
                generatePaymentForService('Consultation Fee', 500);
            } catch (error) {
                showNotification('Failed to book appointment', 'error');
            }
        }

        async function addProgressEntry(event) {
            event.preventDefault();
            const data = {
                metricType: document.getElementById('progressMetric').value,
                value: parseFloat(document.getElementById('progressValue').value),
                notes: document.getElementById('progressNotes').value
            };
            
            try {
                await axios.post(`${API_URL}/progress`, data, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                document.getElementById('progressValue').value = '';
                document.getElementById('progressNotes').value = '';
                loadProgress();
                loadUserHealth();
                showNotification('Progress recorded!', 'success');
            } catch (error) {
                showNotification('Failed to record progress', 'error');
            }
        }

        async function generatePaymentForService(serviceType, amount) {
            try {
                const response = await axios.post(`${API_URL}/payments/generate-qr`, {
                    amount,
                    serviceType
                }, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                showNotification(`Payment of ‚Çπ${amount} generated for ${serviceType}`, 'info');
            } catch (error) {
                console.error('Error generating payment:', error);
            }
        }

        function showPaymentQR(paymentId, amount) {
            currentPaymentId = paymentId;
            document.getElementById('paymentAmount').textContent = amount;
            
            // Generate QR code
            const qrContainer = document.getElementById('qrcode');
            qrContainer.innerHTML = '';
            new QRCode(qrContainer, {
                text: `upi://pay?pa=dietitian@paytm&pn=NutriCare&am=${amount}&cu=INR`,
                width: 200,
                height: 200
            });
            
            document.getElementById('paymentModal').classList.remove('hidden');
        }

        async function confirmPayment() {
            if (!currentPaymentId) return;
            
            const upiTransactionId = prompt('Enter UPI Transaction ID:');
            if (!upiTransactionId) return;
            
            try {
                await axios.put(`${API_URL}/payments/${currentPaymentId}/confirm`, {
                    upiTransactionId
                }, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                
                closeModal('paymentModal');
                loadPayments();
                showNotification('Payment confirmed!', 'success');
            } catch (error) {
                showNotification('Failed to confirm payment', 'error');
            }
        }

        function updateHealthMetrics() {
            const weight = prompt('Enter your current weight (kg):');
            if (weight) {
                addProgressEntry({
                    preventDefault: () => {},
                    target: {
                        progressMetric: { value: 'weight' },
                        progressValue: { value: weight },
                        progressNotes: { value: 'Manual weight update' }
                    }
                });
            }
        }

        function viewDietPlanDetails(planId) {
            // In a real app, this would show a detailed view
            showNotification('Diet plan details view coming soon!', 'info');
        }

        function showCreateDietPlan() {
            // In a real app, this would show a diet plan creation form
            showNotification('Diet plan creator coming soon!', 'info');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        function showNotification(message, type = 'info') {
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-50 fade-in`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Sample diet plan data for demo
        const sampleDietPlan = {
            monday: {
                breakfast: {
                    time: '8:00 AM',
                    items: [
                        { name: 'Oats Porridge', quantity: '1 bowl', calories: 150 },
                        { name: 'Banana', quantity: '1 medium', calories: 105 },
                        { name: 'Almonds', quantity: '5 pieces', calories: 35 }
                    ]
                },
                lunch: {
                    time: '1:00 PM',
                    items: [
                        { name: 'Brown Rice', quantity: '1 cup', calories: 216 },
                        { name: 'Dal', quantity: '1 bowl', calories: 150 },
                        { name: 'Mixed Vegetables', quantity: '1 cup', calories: 80 },
                        { name: 'Curd', quantity: '100g', calories: 60 }
                    ]
                },
                snack: {
                    time: '5:00 PM',
                    items: [
                        { name: 'Green Tea', quantity: '1 cup', calories: 2 },
                        { name: 'Roasted Chickpeas', quantity: '30g', calories: 120 }
                    ]
                },
                dinner: {
                    time: '8:00 PM',
                    items: [
                        { name: 'Roti', quantity: '2 pieces', calories: 140 },
                        { name: 'Paneer Curry', quantity: '150g', calories: 250 },
                        { name: 'Salad', quantity: '1 bowl', calories: 50 }
                    ]
                }
            }
        };

        // Mobile App Info
        function showMobileAppInfo() {
            const mobileInfo = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                    <div class="bg-white rounded-lg p-8 max-w-md w-full">
                        <h3 class="text-2xl font-semibold mb-4">Download Our Mobile App</h3>
                        <div class="text-center mb-6">
                            <div class="mb-4">
                                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2Y0ZjRmNCIvPgogIDx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9IiM2NjYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5RUiBDb2RlPC90ZXh0Pgo8L3N2Zz4=" alt="QR Code" class="mx-auto w-48 h-48 border-2 border-gray-300">
                            </div>
                            <p class="text-gray-600 mb-4">Scan QR code to download</p>
                            <div class="space-y-2">
                                <button class="bg-black text-white px-6 py-2 rounded-lg w-full">Download for iOS</button>
                                <button class="bg-green-600 text-white px-6 py-2 rounded-lg w-full">Download for Android</button>
                            </div>
                        </div>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700">Close</button>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', mobileInfo);
        }
    </script>
</body>
</html>